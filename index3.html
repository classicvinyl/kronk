<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Kronk Hydra (Fullscreen Background)</title>
<style>
/* ---------- BASE + PALETTE ---------- */
:root {
  --c-black:#1a1a1a; --c-white:#e1e1e1; --c-grey:#898989;
  --c-purple:#b462ff; --c-fuschia:#ff45b4; --c-blue:#18b6ff;
  --c-green:#1beb9e; --c-orange:#ff9528; --c-yellow:#dddd25;
  --line:2.5ch;
  --font:'IBM', monospace;
}
html,body{ margin:0; background:var(--c-black); color:var(--c-white); height:100%; font-family:var(--font); line-height:var(--line); }
body { font-size:3.97vw; }
@media (min-width: 768px){ body { font-size:2vw; } }
@media (min-width: 1024px){ body { font-size:1.11111111vw; } }

/* ---------- HYDRA FULLSCREEN BACKGROUND ---------- */
#hydra-bg { position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:0; overflow:hidden; }
#hydra-canvas { width:100%; height:100%; display:block; background:black; pointer-events:none; }

/* ---------- OVERLAY PANELS ---------- */
#links-panel {
  position:fixed; top:0; right:0; width:25vw; max-width:25vw; height:100vh;
  overflow-y:scroll; background:rgba(26,26,26,0.85); padding:var(--line); z-index:2;
  scrollbar-width:none; font-size:1em; line-height:1.3em; white-space:normal; word-break:break-word;
}
#links-panel::-webkit-scrollbar{display:none;}

#info-panel {
  position:fixed; top:0; left:0; z-index:3; font-size:1.3em; background:none; padding:var(--line) 0; line-height:1.3em;
}
#info-panel .info-line { display:inline-block; background:rgba(26,26,26,0.75); padding:0.4ch 0.8ch; margin-bottom:0.6ch; }

.green{color:var(--c-green);}
.grey{color:var(--c-grey);}
.purple{color:var(--c-purple);}
.yellow{color:var(--c-yellow);}
.yellow.hover{cursor:pointer;}
.yellow.hover:hover{opacity:0.7;}

.hidden { display: none; }

.x-multi-column { column-count:1; column-gap:0; }
</style>
</head>
<body>

<!-- ---------- FULLSCREEN HYDRA BACKGROUND ---------- -->
<div id="hydra-bg">
  <canvas id="hydra-canvas"></canvas>
</div>

<script src="https://unpkg.com/hydra-synth"></script>
<script>
window.addEventListener('load', () => {
  const canvas = document.getElementById("hydra-canvas");
  const dpr = window.devicePixelRatio || 1;
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;

  const hydra = new Hydra({ canvas, detectAudio:false, makeGlobal:true });

  // Default initial visual
  osc(10,0.9,300)
    .color(0.9,0.7,0.8)
    .diff( osc(45,0.3,100).color(0.9,0.9,0.9).rotate(0.18).pixelate(12).kaleid() )
    .scrollX(10)
    .colorama()
    .luma()
    .repeatX(4)
    .repeatY(4)
    .modulate( osc(1,-0.9,300) )
    .scale(2)
    .out();

  addEventListener('resize',()=>{
    canvas.width = innerWidth * dpr;
    canvas.height = innerHeight * dpr;
    if(hydra.resize) hydra.resize();
  });
});
</script>

<!-- ---------- LINKS PANEL ---------- -->
<aside id="links-panel" style="width:25vw; max-width:25vw; font-size:1.3em; line-height:1.35em;">
  <div class="green x-multi-column">
    <!-- Full link list -->
    <a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-7" target="_blank">Ecstatic Edits #7</a><br>
    <a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-6" target="_blank">Ecstatic Edits #6</a><br>
    <!-- (more links here, truncated for brevity) -->
  </div>
</aside>

<!-- ---------- INFO PANEL ---------- -->
<nav id="info-panel" class="noselect">
  <div id="playing-line" class="info-line hidden">
    <span class="green">[playing]</span> <span class="grey">Loading...</span>
  </div>
  <div class="info-line"><span class="yellow hover">[sound on]</span></div>
</nav>

<audio id="audio-player"></audio>

<script src="https://cdn.jsdelivr.net/npm/hydra-synth@2.0.0"></script>
<script>
  // --- CONFIG ---
  const mp3Folder = "mp3/";
  const mp3Files = [
    "magnetize - hardcopy.mp3",
    "nwyvre - exotnotics.mp3",
    "nwyvre - harmonic4.mp3",
    "nwyvre - red light.mp3",
    "nwyvre - solar bones.mp3",
    "soundbreaking sky - noble bull kell.mp3",
    "soundbreaking sky - sbs 19-1.mp3",
    "soundbreaking sky - sbs 2.3.mp3",
    "soundbreaking sky - sbs 22.2.mp3",
    "uous - abort.mp3",
    "uous - still feeling it.mp3",
    "whirling hall of knives - blown vestige.mp3",
    "whirling hall of knives - greywash.mp3"
  ];

  const audio = document.getElementById("audio-player");

  function stripExtension(filename) { return filename.replace(/\.mp3$/i, ""); }

  function playRandomMP3(infoGrey) {
    if(mp3Files.length === 0) return;
    const file = mp3Files[Math.floor(Math.random()*mp3Files.length)];
    audio.src = mp3Folder + file;
    audio.play().catch(err=>console.log("Audio blocked until user interacts",err));
    if(infoGrey) infoGrey.textContent = stripExtension(file);
  }

  function randomHydraSnippet() {
    const freq = Math.random()*20+2;
    const amp = Math.random()*0.8+0.2;
    const kaleid = Math.floor(Math.random()*12+2);
    const scroll = Math.floor(Math.random()*20);
    return `
      osc(${freq}, ${amp}, ${scroll})
        .color(${Math.random()}, ${Math.random()}, ${Math.random()})
        .diff( osc(${freq*3}, ${Math.random()*0.5+0.1}, ${scroll*2})
          .color(${Math.random()},${Math.random()},${Math.random()})
          .rotate(${Math.random()*0.5-0.25})
          .pixelate(${Math.floor(Math.random()*16)+2})
          .kaleid(${kaleid}) )
        .scrollX(${scroll})
        .colorama()
        .luma()
        .repeatX(${Math.floor(Math.random()*6)+1})
        .repeatY(${Math.floor(Math.random()*6)+1})
        .modulate( osc(${Math.random()*3}, ${Math.random()*2-1}, ${Math.random()*300}) )
        .scale(${Math.random()*3+1})
        .out();
    `;
  }

  function runRandomHydra() { eval(randomHydraSnippet()); }
  function randomizeAll(infoGrey) { playRandomMP3(infoGrey); runRandomHydra(); }

  document.addEventListener("DOMContentLoaded", ()=>{
    const randomSpan = document.querySelector(".info-line .yellow.hover");
    const playingLine = document.getElementById("playing-line");
    const infoGrey = playingLine.querySelector(".grey");

    if(!randomSpan) return;

    randomSpan.textContent="[sound on]";
    randomSpan.style.cursor="pointer";

    randomSpan.addEventListener("click", ()=>{
      if(randomSpan.textContent === "[sound on]") {
        randomSpan.textContent="[random]";
        if(playingLine) playingLine.classList.remove("hidden");
      }
      randomizeAll(infoGrey);
    });
  });
</script>

</body>
</html>
