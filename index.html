<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>kronk</title>

<style>

#links-panel {
  display: none;
}

.info-line span {
  cursor: pointer;
}

/* ---------- BASE + PALETTE ---------- */
:root {
  --c-black:#1a1a1a; --c-white:#e1e1e1; --c-grey:#898989;
  --c-purple:#b462ff; --c-fuschia:#ff45b4; --c-blue:#18b6ff;
  --c-green:#1beb9e; --c-orange:#ff9528; --c-yellow:#dddd25;
  --line:2.5ch;
  --font:'IBM', monospace;
}
html,body{
  margin:0;
  background:var(--c-black);
  color:var(--c-white);
  height:100%;
  font-family:var(--font);
  line-height:var(--line);
}

body { font-size:3.97vw; }
@media (min-width: 768px) { body { font-size:2vw; } }
@media (min-width: 1024px) { body { font-size:1.11111111vw; } } 

/* ---------- HYDRA FULLSCREEN BACKGROUND ---------- */
#hydra-bg {
  position:fixed;
  top:0; left:0;
  width:100vw;
  height:100vh;
  z-index:0;
  overflow:hidden;
}
#hydra-canvas {
  width:100%; height:100%; display:block; background:black;
  pointer-events:none;
}

/* ---------- OVERLAY PANELS ---------- */
#links-panel {
  position:fixed;
  top:0;
  right:0;
  width:25vw !important;
  max-width:25vw !important;
  height:100vh;
  overflow-y:scroll;
  background:rgba(26,26,26,0.85);
  padding:var(--line);
  z-index:2;
  scrollbar-width:none;
  font-size:1em;
  line-height:1.3em;
  white-space:normal !important;
  word-break:break-word;
}
#links-panel::-webkit-scrollbar{display:none;}

#info-panel {
  position:fixed;
  top:0;
  left:0;
  z-index:3;
  font-size:1.3em;
  background:none;
  padding:var(--line) 0;
  line-height:1.3em;
}
#info-panel .info-line {
  display:inline-block;
  background:rgba(26,26,26,0.75);
  padding:0.4ch 0.8ch;
  margin-bottom:0.6ch;
}
#info-panel .info-wrap {
  display:inline-block;
  background:rgba(26,26,26,0.75);
  padding:calc(var(--line) * 0.6);
}

/* ---------- TYPE ---------- */
a {color:inherit; text-decoration:none;}
a:hover {color:var(--c-black); background:var(--c-current);} 

.green{color:var(--c-green); --c-current:var(--c-green);} 
.grey{color:var(--c-grey); --c-current:var(--c-grey);} 
.purple{color:var(--c-purple); --c-current:var(--c-purple);} 
.yellow{color:var(--c-yellow); --c-current:var(--c-yellow);} 

.x-multi-column { column-count:1; column-gap:0; }

/* ---------- MOBILE STYLING ---------- */
@media (max-width: 768px) {
  #mobile-wrapper {
    display: flex;
    flex-direction: column;
  }

  #info-panel {
    position: relative !important;
    z-index: 2 !important;
    margin-bottom: 0.5em;
  }

  #links-panel {
    position: relative !important;
    top: auto !important;
    right: auto !important;
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    background: rgba(26,26,26,0.9) !important;
    padding: calc(var(--line)/2) !important;
    z-index: 1 !important;
    overflow: visible !important;
  }
}
</style>
</head>
<body>

<!-- ---------- FULLSCREEN HYDRA BACKGROUND ---------- -->
<div id="hydra-bg">
  <canvas id="hydra-canvas"></canvas>
</div>
<script src="https://unpkg.com/hydra-synth"></script>
<script>
window.addEventListener('load', () => {
  const canvas = document.getElementById("hydra-canvas");
  const dpr = window.devicePixelRatio || 1;
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;

  const hydra = new Hydra({ canvas, detectAudio:false, makeGlobal:true });

  osc(10,0.9,300)
    .color(0.9,0.7,0.8)
    .diff( osc(45,0.3,100).color(0.9,0.9,0.9).rotate(0.18).pixelate(12).kaleid() )
    .scrollX(10)
    .colorama()
    .luma()
    .repeatX(4)
    .repeatY(4)
    .modulate( osc(1,-0.9,300) )
    .scale(2)
    .out();

  addEventListener('resize',()=>{
    canvas.width = innerWidth * dpr;
    canvas.height = innerHeight * dpr;
    if(hydra.resize) hydra.resize();
  });
});
</script>

<!-- ---------- MOBILE WRAPPER ---------- -->
<div id="mobile-wrapper">

  <nav id="info-panel" class="noselect">
    <div class="info-line"><span class="green">[playing]</span> <span class="grey"></span></div><br>
    <div class="info-line"><span class="yellow hover">[sound on]</span></div><br>
    <div class="info-line"><span class="purple hover" id="discog-button">[discog]</span></div>
  </nav>

  <aside id="links-panel" style="width:25vw; max-width:25vw; font-size:1.3em; line-height:1.35em;">
    <div class="green x-multi-column">
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-7" target="_blank">Ecstatic Edits #7</a><br>
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-6" target="_blank">Ecstatic Edits #6</a><br>
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-5" target="_blank">Ecstatic Edits #5</a><br>
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-4" target="_blank">Ecstatic Edits #4</a><br>
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-3" target="_blank">Ecstatic Edits #3</a><br>
<a href="https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-2" target="_blank">Ecstatic Edits #2</a><br>
    </div>
  </aside>

</div>

<audio id="audio-player"></audio>

<script>
// --- CONFIG ---
const mp3Folder = "mp3/";
const mp3Files = [
  { file: "magnetize - hardcopy.mp3", link: "https://open.spotify.com/album/57ZDxDAMO5jVi7f0OTLYxA?si=34vX_5cHRhSMBjUQEsXGvg&nd=1&dlsi=50a70d96477247d0" },
  { file: "nwyvre - exotnotics.mp3", link: "https://fortevilfruit.bandcamp.com/album/manifes" },
  { file: "nwyvre - harmonic4.mp3", link: "https://nwyvre.bandcamp.com/album/harmonic" },
  { file: "nwyvre - red light.mp3", link: "https://fortevilfruit.bandcamp.com/album/pattern-collapse" },
  { file: "nwyvre - solar bones.mp3", link: "https://www.thewire.co.uk/audio/btr/below-the-radar-39" },
  { file: "nwyvre - morrigu7.mp3", link: "https://nwyvre.bandcamp.com/album/morrigu" },
  { file: "nwyvre - wadjet4.mp3", link: "https://nwyvre.bandcamp.com/album/wadjet" },
  { file: "soundbreaking sky - noble bull kell.mp3", link: "https://soundbreakingsky.bandcamp.com/album/ecstatic-edits-2" },
  { file: "soundbreaking sky - sbs 19-1.mp3", link: "https://soundbreakingsky.bandcamp.com/album/sbs-19" },
  { file: "soundbreaking sky - sbs 2.3.mp3", link: "https://soundbreakingsky.bandcamp.com/album/sbs-2" },
  { file: "soundbreaking sky - sbs 22.2.mp3", link: "https://soundbreakingsky.bandcamp.com/album/sbs-22" },
  { file: "uous - abort.mp3", link: "https://cruelnaturerecordings.bandcamp.com/album/scrawled" },
  { file: "uous - still feeling it.mp3", link: "https://cruelnaturerecordings.bandcamp.com/album/scrawled" },
  { file: "magnetize - gravity lensing.mp3", link: "https://open.spotify.com/album/5fb0tv1RUMYGa2QIFOz4tC?si=-GdCunsmTR2rP10ZWEMFeQ&nd=1&dlsi=979f3f8a64174561" },
  { file: "magnetize - noise to signal.mp3", link: "https://www.discogs.com/Magnetize-Noise-To-Signal/release/1029458" },
  { file: "magnetize - overflux.mp3", link: "https://open.spotify.com/album/5dVn4qsa3CfzG6oplIATLe?si=SG1P10wJRPSIEyTYluXHtA&nd=1&dlsi=9842987cc22b4b9d" },
  { file: "valved - blood on the controls (whok mix1).mp3", link: "https://trensmat.bandcamp.com/album/and-whok-remixes" },
  { file: "whirling hall of knives - blown vestige.mp3", link: "https://cruelnaturerecordings.bandcamp.com/album/blown-vestige" },
  { file: "whirling hall of knives - greywash.mp3", link: "https://cruelnaturerecordings.bandcamp.com/album/recoil-greywash" },
  { file: "whirling hall of knives - acheron.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/decate" },
  { file: "whirling hall of knives - alternate devil.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/devisions" },
  { file: "whirling hall of knives - blister pack.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/decate" },
  { file: "whirling hall of knives - comminute.mp3", link: "https://earwiggle.bandcamp.com/album/whirling-hall-of-knives-comminute-ep" },
  { file: "whirling hall of knives - druckmasch.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/voix" },
  { file: "whirling hall of knives - fyls.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/voix" },
  { file: "whirling hall of knives - myrekrig.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/devisions" },
  { file: "whirling hall of knives - permafroste.mp3", link: "https://fortevilfruit.bandcamp.com/album/p-ggz" },
  { file: "whirling hall of knives - rattle & sturm.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/decate" },
  { file: "whirling hall of knives - selectiv compliance.mp3", link: "https://nuterecords.bandcamp.com/album/selectiv-compliance-nute012" },
  { file: "whirling hall of knives - selectivsnapp.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/voix" },
  { file: "whirling hall of knives - sh:loads.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/seacht" },
  { file: "whirling hall of knives - sol tryst.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/voix" },
  { file: "whirling hall of knives - wraith.mp3", link: "https://whirlinghallofknives.bandcamp.com/album/devisions" }
];

const audio = document.getElementById("audio-player");
const randomSpan = document.querySelector(".info-line .yellow.hover");
const infoLine = document.querySelector("#info-panel .info-line");
const infoGrey = infoLine ? infoLine.querySelector(".grey") : null;
const infoGreen = infoLine ? infoLine.querySelector(".green") : null;

// Remove “.mp3”
function stripExtension(filename) { return filename.replace(/\.[^/.]+$/, ""); }

// Shuffle bag
let shuffleBag = [];
function refillShuffleBag() { shuffleBag = mp3Files.slice(); fisherYatesShuffle(shuffleBag); }
function fisherYatesShuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} }
function getNextRandomMP3(){ if(shuffleBag.length===0) refillShuffleBag(); return shuffleBag.pop(); }

function playRandomMP3() {
  const track = getNextRandomMP3();
  const title = stripExtension(track.file);
  audio.src = mp3Folder + track.file;
  audio.play().catch(()=>{});
  if (infoGrey) infoGrey.innerHTML = `<a href="${track.link}" target="_blank">${title}</a>`;
}

audio.addEventListener("ended", playRandomMP3);

// --- ONLY CHANGE REQUESTED ---
// initial state shows [sound on]
if (randomSpan) randomSpan.textContent = "[sound on]";
let soundStarted = false;
// hide [playing] text initially
if (infoLine) infoLine.style.display = "none";

if (randomSpan) {
  randomSpan.style.cursor = "pointer";
  randomSpan.addEventListener("click", () => {
    if (!soundStarted) {
      soundStarted = true;
      randomSpan.textContent = "[random]";   // revert on first click
      if (infoGreen) infoGreen.textContent = "[playing]";
      if (infoLine) infoLine.style.display = "inline-block";
    }
    playRandomMP3();
    randomizeHydra();
  });
}

// hydra randomise
function randomizeHydra() {
  const f1 = 5 + Math.random()*40;
  const f2 = 20 + Math.random()*80;
  const rot = Math.random()*3.14;
  const pix = 5 + Math.random()*30;

  osc(f1,0.9,300)
    .color(Math.random(),Math.random(),Math.random())
    .diff(
      osc(f2,0.3,100)
        .color(Math.random(),Math.random(),Math.random())
        .rotate(rot)
        .pixelate(pix)
        .kaleid()
    )
    .scrollX(Math.random()*20 - 10)
    .colorama()
    .luma()
    .repeatX(2 + Math.floor(Math.random()*4))
    .repeatY(2 + Math.floor(Math.random()*4))
    .modulate(osc(1,Math.random()*-2,300))
    .scale(1 + Math.random()*2)
    .out();
}

// links toggle
const linksPanel = document.getElementById("links-panel");
const discogButton = document.getElementById("discog-button");
if (discogButton && linksPanel) {
  discogButton.addEventListener("click", () => {
    const hidden = window.getComputedStyle(linksPanel).display === "none";
    linksPanel.style.display = hidden ? "block" : "none";
  });
}
</script>

</body>
</html>
